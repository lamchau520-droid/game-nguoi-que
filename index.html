<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pixel World RPG</title>

<style>
body{
  margin:0;
  background:#000;
  overflow:hidden;
}
canvas{
  display:block;
  margin:auto;
  background:#8fd3ff;
}
#ui{
  position:fixed;
  top:10px;
  left:10px;
  color:white;
  background:rgba(0,0,0,0.6);
  padding:8px;
  border-radius:8px;
  font-size:14px;
}
.controls{
  position:fixed;
  bottom:20px;
  width:100%;
  display:flex;
  justify-content:center;
  gap:20px;
}
.btn{
  width:60px;
  height:60px;
  border-radius:12px;
  border:none;
  font-size:24px;
}
</style>
</head>

<body>

<div id="ui">
LV: 1<br>
HP: 100<br>
Gold: 0
</div>

<canvas id="game" width="360" height="640"></canvas>

<div class="controls">
  <button class="btn"
    ontouchstart="left=true"
    ontouchend="left=false">←</button>

  <button class="btn" onclick="attack()">⚔</button>

  <button class="btn"
    ontouchstart="right=true"
    ontouchend="right=false">→</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// ===== LOAD IMAGES =====
const playerImg = new Image();
playerImg.src = "player_walk.png";

const groundImg = new Image();
groundImg.src = "ground.png";

// ===== PLAYER =====
const player = {
  x: 160,
  y: 420,
  w: 32,
  h: 32,
  speed: 2,
  frame: 0,
  maxFrame: 4,
  tick: 0,
  moving: false
};

// ===== CONTROL FLAGS =====
let left = false;
let right = false;

// ===== DRAW PLAYER =====
function drawPlayer(){
  if(!playerImg.complete) return;

  ctx.drawImage(
    playerImg,
    player.frame * 32, 0,
    32, 32,
    player.x, player.y,
    32, 32
  );
}

// ===== DRAW GROUND =====
function drawGround(){
  if(!groundImg.complete){
    ctx.fillStyle = "#1f7a1f";
    ctx.fillRect(0,480,canvas.width,160);
    return;
  }
  for(let x=0; x<canvas.width; x+=32){
    ctx.drawImage(groundImg, x, 480, 32, 32);
  }
}

// ===== ATTACK =====
function attack(){
  alert("Tấn công!");
}

// ===== GAME LOOP =====
function gameLoop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // SKY
  ctx.fillStyle = "#8fd3ff";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // MOVE
  player.moving = false;
  if(left){
    player.x -= player.speed;
    player.moving = true;
  }
  if(right){
    player.x += player.speed;
    player.moving = true;
  }

  // ANIMATION
  player.tick++;
  if(player.tick > 10){
    if(player.moving){
      player.frame = (player.frame + 1) % player.maxFrame;
    }else{
      player.frame = 0;
    }
    player.tick = 0;
  }

  drawGround();
  drawPlayer();

  requestAnimationFrame(gameLoop);
}

gameLoop();
</script>

</body>
</html>
