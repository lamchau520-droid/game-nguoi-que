<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Game Người Que</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html,body{
  margin:0;
  padding:0;
  background:black;
}
canvas{
  display:block;
  margin:auto;
  background:#8fd3ff;
}
</style>
</head>

<body>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// KHUNG GAME CỐ ĐỊNH (DỄ NHÌN TRÊN ĐIỆN THOẠI)
canvas.width = 360;
canvas.height = 640;

// LOAD ẢNH
const playerImg = new Image();
playerImg.src = "./player_walk.png";

const groundImg = new Image();
groundImg.src = "./ground.png";

let loaded = 0;
[playerImg, groundImg].forEach(img=>{
  img.onload = ()=>loaded++;
});

// PLAYER
const player = {
  x: 80,
  y: 0,
  w: 32,
  h: 32,
  frame: 0,
  tick: 0
};

function gameLoop(){
  if(loaded < 2){
    ctx.fillStyle="white";
    ctx.fillText("Loading...",140,320);
    requestAnimationFrame(gameLoop);
    return;
  }

  ctx.clearRect(0,0,canvas.width,canvas.height);

  // ĐẤT
  for(let x=0;x<canvas.width;x+=32){
    ctx.drawImage(groundImg,x,canvas.height-32,32,32);
  }

  // GRAVITY
  player.y += 4;
  if(player.y + player.h > canvas.height-32){
    player.y = canvas.height-32-player.h;
  }

  // ANIMATION
  player.tick++;
  if(player.tick > 8){
    player.frame = (player.frame+1)%4;
    player.tick = 0;
  }

  ctx.drawImage(
    playerImg,
    player.frame*32,0,32,32,
    player.x,player.y,48,48
  );

  requestAnimationFrame(gameLoop);
}

gameLoop();
</script>
</body>
</html>
