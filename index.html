<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Pixel Dungeon RPG</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;background:black;overflow:hidden}
canvas{display:block;margin:auto}
.btn{
 position:fixed;width:50px;height:50px;
 background:white;border-radius:10px;font-size:18px
}
#l{left:20px;bottom:80px}
#r{left:140px;bottom:80px}
#a{right:20px;bottom:80px}
#s{right:20px;bottom:140px;background:orange}
</style>
</head>
<body>

<canvas id="c" width="360" height="640"></canvas>
<button id="l" class="btn">â—€</button>
<button id="r" class="btn">â–¶</button>
<button id="a" class="btn">âš”</button>
<button id="s" class="btn">ðŸ”¥</button>

<script>
const ctx=c.getContext("2d");

// ===== LOAD SPRITE =====
const playerImg=new Image();
playerImg.src="https://i.imgur.com/1XKz8vR.png";
const bossImg=new Image();
bossImg.src="https://i.imgur.com/l7YpY7C.png";

// ===== GAME STATE =====
let dungeon=1;
let gold=0;
let skillCD=0;

// ===== PLAYER =====
const p={x:160,y:420,hp:100,max:100,frame:0,dir:1};

// ===== BOSS =====
let boss={x:260,y:420,hp:200,max:200,alive:true};

// ===== CONTROL =====
let L=false,R=false,ATK=false,SKILL=false;
l.ontouchstart=()=>L=true; l.ontouchend=()=>L=false;
r.ontouchstart=()=>R=true; r.ontouchend=()=>R=false;
a.ontouchstart=()=>ATK=true; a.ontouchend=()=>ATK=false;
s.ontouchstart=()=>SKILL=true; s.ontouchend=()=>SKILL=false;

// ===== UPDATE =====
function update(){
 if(L){p.x-=3;p.frame++}
 if(R){p.x+=3;p.frame++}
 p.x=Math.max(0,Math.min(320,p.x));

 if(skillCD>0)skillCD--;

 // attack
 if(ATK && boss.alive && Math.abs(p.x-boss.x)<40){
  boss.hp-=1;
 }

 // skill
 if(SKILL && skillCD==0 && boss.alive){
  boss.hp-=20;
  skillCD=120;
 }

 // boss dead
 if(boss.hp<=0 && boss.alive){
  boss.alive=false;
  gold+=20;
  setTimeout(nextDungeon,1000);
 }
}

// ===== NEXT DUNGEON =====
function nextDungeon(){
 dungeon++;
 boss={x:260,y:420,hp:200+50*dungeon,max:200+50*dungeon,alive:true};
}

// ===== DRAW =====
function bar(x,y,w,h,val,max,col){
 ctx.fillStyle="gray";
 ctx.fillRect(x,y,w,h);
 ctx.fillStyle=col;
 ctx.fillRect(x,y,w*(val/max),h);
}

function draw(){
 // background
 ctx.fillStyle=dungeon==1?"#87ceeb":"#333";
 ctx.fillRect(0,0,360,640);
 ctx.fillStyle=dungeon==1?"#1f7a1f":"#111";
 ctx.fillRect(0,480,360,160);

 // player (animation)
 ctx.drawImage(playerImg,(p.frame%4)*32,0,32,32,p.x,p.y,32,32);

 // boss
 if(boss.alive)
  ctx.drawImage(bossImg,boss.x,boss.y,48,48);

 // UI
 bar(10,10,100,10,p.hp,p.max,"red");
 if(boss.alive)
  bar(10,30,120,10,boss.hp,boss.max,"purple");

 ctx.fillStyle="white";
 ctx.fillText("Gold: "+gold,10,55);
 ctx.fillText("Dungeon: "+dungeon,10,70);
}

function loop(){
 update();
 draw();
 requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>

